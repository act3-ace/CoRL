
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The following python project creates a python interface for training Deep RL - provides the base RL functionality and APIs to enable rapid ablation testing and setup. The Core Reinforcement Learning library is intended to enable scalable deep reinforcement learning experimentation in a manner extensible to new simulations and new ways for the learning agents to interact with them. The hope is that this makes RL research easier by removing lock-in to particular simulations.">
      
      
        <meta name="author" content="ACT3">
      
      
        <link rel="canonical" href="https://act3-ace.github.io/CoRL/reference/libraries/env_space_util/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.3">
    
    
      
        <title>Env space util - ACT3 RL Core - CoRL</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/style.css">
    
      <link rel="stylesheet" href="../../../css/material.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#corl.libraries.env_space_util" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ACT3 RL Core - CoRL" class="md-header__button md-logo" aria-label="ACT3 RL Core - CoRL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ACT3 RL Core - CoRL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Env space util
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/act3-ace/CoRL" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    CoRL
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Introduction
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../concepts/" class="md-tabs__link">
      Concepts
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../configuration/" class="md-tabs__link">
      Configuration
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../install/" class="md-tabs__link">
      Install
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../license/" class="md-tabs__link">
      License
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../tasks/docking_1d/" class="md-tabs__link">
        Tasks
      </a>
    </li>
  

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="../../SUMMARY/" class="md-tabs__link md-tabs__link--active">
      ACT3 CORE
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../change_log/" class="md-tabs__link">
      Change log
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ACT3 RL Core - CoRL" class="md-nav__button md-logo" aria-label="ACT3 RL Core - CoRL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6Z"/></svg>

    </a>
    ACT3 RL Core - CoRL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/act3-ace/CoRL" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    CoRL
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../concepts/">Concepts</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Concepts" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../diverse-frame-rate/" class="md-nav__link">
        Diverse frame rate
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../install/" class="md-nav__link">
        Install
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Tasks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tasks" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Tasks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tasks/docking_1d/" class="md-nav__link">
        Docking 1D
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../SUMMARY/">ACT3 CORE</a>
          
            <label for="__nav_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="ACT3 CORE" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          ACT3 CORE
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../__init__/" class="md-nav__link">
          init  
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../train_rl/" class="md-nav__link">
        Train rl
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3">
          Evaluation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Evaluation" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Evaluation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/cli_generate_metrics.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/cli_visualize.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/default_config_updates.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/episode_artifact.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/eval_logger_name.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/evaluation_outcome.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/scene_processors.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/serialize_platforms.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_10" type="checkbox" id="__nav_7_3_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_10">
          Launchers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Launchers" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_3_10">
          <span class="md-nav__icon md-icon"></span>
          Launchers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/launchers/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/launchers/evaluate_from_config.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_11" type="checkbox" id="__nav_7_3_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_11">
          Loaders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Loaders" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_3_11">
          <span class="md-nav__icon md-icon"></span>
          Loaders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/loader/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/loader/check_point_file.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/loader/heuristic.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/loader/i_agent_loader.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/loader/weight_file.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_12" type="checkbox" id="__nav_7_3_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_12">
          Metrics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Metrics" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_3_12">
          <span class="md-nav__icon md-icon"></span>
          Metrics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/alerts.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/generator.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/metric.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/processors.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/scenario_alert_generators.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/scenario_metric_generators.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/scopes.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_12_9" type="checkbox" id="__nav_7_3_12_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_12_9">
          Aggregators
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Aggregators" data-md-level="4">
        <label class="md-nav__title" for="__nav_7_3_12_9">
          <span class="md-nav__icon md-icon"></span>
          Aggregators
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/aggregators/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/aggregators/accumulate.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/aggregators/average.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/aggregators/criteria_rate.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/aggregators/sum.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_12_10" type="checkbox" id="__nav_7_3_12_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_12_10">
          Generators
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Generators" data-md-level="4">
        <label class="md-nav__title" for="__nav_7_3_12_10">
          <span class="md-nav__icon md-icon"></span>
          Generators
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/generators/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/generators/dones.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/generators/rewards.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/generators/meta/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/generators/meta/episode_length.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/generators/meta/runtime.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_12_11" type="checkbox" id="__nav_7_3_12_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_12_11">
          Types
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Types" data-md-level="4">
        <label class="md-nav__title" for="__nav_7_3_12_11">
          <span class="md-nav__icon md-icon"></span>
          Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/nonterminals/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/nonterminals/dict.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/nonterminals/timed_value.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/nonterminals/vector.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/terminals/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/terminals/discrete.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/terminals/rate.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/terminals/real.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/terminals/string.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/types/terminals/void.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_12_12" type="checkbox" id="__nav_7_3_12_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_12_12">
          Recording
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Recording" data-md-level="4">
        <label class="md-nav__title" for="__nav_7_3_12_12">
          <span class="md-nav__icon md-icon"></span>
          Recording
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/recording/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/recording/folder.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/recording/i_recorder.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_12_13" type="checkbox" id="__nav_7_3_12_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_12_13">
          Runners
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Runners" data-md-level="4">
        <label class="md-nav__title" for="__nav_7_3_12_13">
          <span class="md-nav__icon md-icon"></span>
          Runners
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/iterate_test_cases.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/task.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/teams.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/engine/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/engine/rllib/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/engine/rllib/default_evaluation_callbacks.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/engine/rllib/eval_config_updates.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/engine/rllib/rllib_trainer.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/plugins/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/plugins/config_updater.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/plugins/platform_serializer.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/plugins/plugins.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/test_cases/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/test_cases/config_parser.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/test_cases/pandas.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/runners/section_factories/test_cases/test_case_generator.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_12_14" type="checkbox" id="__nav_7_3_12_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_12_14">
          Util
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Util" data-md-level="4">
        <label class="md-nav__title" for="__nav_7_3_12_14">
          <span class="md-nav__icon md-icon"></span>
          Util
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/util/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/util/condition.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3_12_15" type="checkbox" id="__nav_7_3_12_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3_12_15">
          Visualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Visualization" data-md-level="4">
        <label class="md-nav__title" for="__nav_7_3_12_15">
          <span class="md-nav__icon md-icon"></span>
          Visualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/visualization/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/visualization/print.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/visualization/visualization.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_4" type="checkbox" id="__nav_7_4" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../agents/__init__/">Agents</a>
          
            <label for="__nav_7_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Agents" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          Agents
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../agents/base_agent/" class="md-nav__link">
        Base agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../agents/noop_agent.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../agents/random_action_agent.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../dones/__init__/">Dones</a>
          
            <label for="__nav_7_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Dones" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Dones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dones/done_func_base/" class="md-nav__link">
        Done func base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dones/done_func_multi_wrapper/" class="md-nav__link">
        Done func multi wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dones/done_func_wrapper/" class="md-nav__link">
        Done func wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dones/episode_length_done/" class="md-nav__link">
        Episode length done
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dones/openai_gym_done/" class="md-nav__link">
        Openai gym done
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dones/sensor_bounds_check_done/" class="md-nav__link">
        Sensor bounds check done
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dones/done_func_dict_wrapper/" class="md-nav__link">
        Done func dict wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5_8" type="checkbox" id="__nav_7_5_8" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../dones/docking_1d/__init__/">Docking 1D</a>
          
            <label for="__nav_7_5_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Docking 1D" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_5_8">
          <span class="md-nav__icon md-icon"></span>
          Docking 1D
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dones/docking_1d/dones/" class="md-nav__link">
        Dones
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_6" type="checkbox" id="__nav_7_6" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../models/__init__/">Models</a>
          
            <label for="__nav_7_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Models" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_6">
          <span class="md-nav__icon md-icon"></span>
          Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/frame_stacking/" class="md-nav__link">
        Frame stacking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../models/torch_frame_stack/" class="md-nav__link">
        Torch frame stack
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_7" type="checkbox" id="__nav_7_7" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../environment/__init__/">Environment</a>
          
            <label for="__nav_7_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Environment" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Environment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/default_env_rllib_callbacks/" class="md-nav__link">
        Default env rllib callbacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/gym_env/" class="md-nav__link">
        Gym env
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/multi_agent_env/" class="md-nav__link">
        Multi agent env
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/utils/__init__/" class="md-nav__link">
          init  
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/utils/env_creation/" class="md-nav__link">
        Env creation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/utils/obs_buffer/" class="md-nav__link">
        Obs buffer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../environment/utils/space_sort/" class="md-nav__link">
        Space sort
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_8" type="checkbox" id="__nav_7_8" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../episode_parameter_providers/__init__/">Episode Parameter Provider</a>
          
            <label for="__nav_7_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Episode Parameter Provider" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_8">
          <span class="md-nav__icon md-icon"></span>
          Episode Parameter Provider
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../episode_parameter_providers/adr.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../episode_parameter_providers/core/" class="md-nav__link">
        Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../episode_parameter_providers/remote/" class="md-nav__link">
        Remote
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../episode_parameter_providers/simple/" class="md-nav__link">
        Simple
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../episode_parameter_providers/tabular_parameter_provider.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_9" type="checkbox" id="__nav_7_9" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../experiments/__init__/">Experiments</a>
          
            <label for="__nav_7_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Experiments" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_9">
          <span class="md-nav__icon md-icon"></span>
          Experiments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/base_experiment/" class="md-nav__link">
        Base experiment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/rllib_experiment/" class="md-nav__link">
        Rllib experiment
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_10" type="checkbox" id="__nav_7_10" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../glues/__init__/">Glues</a>
          
            <label for="__nav_7_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Glues" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_10">
          <span class="md-nav__icon md-icon"></span>
          Glues
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/base_glue/" class="md-nav__link">
        Base glue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/base_multi_wrapper/" class="md-nav__link">
        Base multi wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/base_wrapper/" class="md-nav__link">
        Base wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/base_dict_wrapper/" class="md-nav__link">
        Base dict wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_10_5" type="checkbox" id="__nav_7_10_5" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../glues/common/__init__/">Common</a>
          
            <label for="__nav_7_10_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Common" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_10_5">
          <span class="md-nav__icon md-icon"></span>
          Common
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/common/observe_part_validity/" class="md-nav__link">
        Observe part validity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/common/arithmetic_multi_glue/" class="md-nav__link">
        Arithmetic multi glue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/common/controller_glue/" class="md-nav__link">
        Controller glue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/common/observe_sensor/" class="md-nav__link">
        Observe sensor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/common/observe_sensor_repeated/" class="md-nav__link">
        Observe sensor repeated
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/common/target_value/" class="md-nav__link">
        Target value
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/common/target_value_difference/" class="md-nav__link">
        Target value difference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/common/projected_quantity/" class="md-nav__link">
        Projected quantity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_10_6" type="checkbox" id="__nav_7_10_6" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../glues/controller_wrappers/__init__/">Controller Wrappers</a>
          
            <label for="__nav_7_10_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Controller Wrappers" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_10_6">
          <span class="md-nav__icon md-icon"></span>
          Controller Wrappers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/controller_wrappers/obs_relative_delta_controller_dict/" class="md-nav__link">
        Obs relative delta controller dict
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/controller_wrappers/delta_controller/" class="md-nav__link">
        Delta controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../glues/controller_wrappers/obs_relative_delta_controller/" class="md-nav__link">
        Obs relative delta controller
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_11" type="checkbox" id="__nav_7_11" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../__init__/">Libraries</a>
          
            <label for="__nav_7_11">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Libraries" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_11">
          <span class="md-nav__icon md-icon"></span>
          Libraries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cleanup/" class="md-nav__link">
        Cleanup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../collection_utils/" class="md-nav__link">
        Collection utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../env_common/" class="md-nav__link">
        Env common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../env_func_base/" class="md-nav__link">
        Env func base
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Env space util
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Env space util
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util" class="md-nav__link">
    corl.libraries.env_space_util
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil" class="md-nav__link">
    EnvSpaceUtil
  </a>
  
    <nav class="md-nav" aria-label="EnvSpaceUtil">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.add_space_samples" class="md-nav__link">
    add_space_samples()
  </a>
  
    <nav class="md-nav" aria-label="add_space_samples()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.add_space_samples--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler" class="md-nav__link">
    box_scaler()
  </a>
  
    <nav class="md-nav" aria-label="box_scaler()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler" class="md-nav__link">
    box_unscaler()
  </a>
  
    <nav class="md-nav" aria-label="box_unscaler()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space" class="md-nav__link">
    clip_space_sample_to_space()
  </a>
  
    <nav class="md-nav" aria-label="clip_space_sample_to_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space" class="md-nav__link">
    convert_config_param_to_space()
  </a>
  
    <nav class="md-nav" aria-label="convert_config_param_to_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_merge_dict" class="md-nav__link">
    deep_merge_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_sanity_check_space_sample" class="md-nav__link">
    deep_sanity_check_space_sample()
  </a>
  
    <nav class="md-nav" aria-label="deep_sanity_check_space_sample()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_sanity_check_space_sample--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space" class="md-nav__link">
    get_mean_sample_from_space()
  </a>
  
    <nav class="md-nav" aria-label="get_mean_sample_from_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space" class="md-nav__link">
    get_zero_sample_from_space()
  </a>
  
    <nav class="md-nav" aria-label="get_zero_sample_from_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes" class="md-nav__link">
    iterate_over_space_likes()
  </a>
  
    <nav class="md-nav" aria-label="iterate_over_space_likes()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space" class="md-nav__link">
    normalize_space()
  </a>
  
    <nav class="md-nav" aria-label="normalize_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample" class="md-nav__link">
    sanity_check_space_sample()
  </a>
  
    <nav class="md-nav" aria-label="sanity_check_space_sample()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample--raises" class="md-nav__link">
    Raises
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space" class="md-nav__link">
    scale_sample_from_space()
  </a>
  
    <nav class="md-nav" aria-label="scale_sample_from_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_space" class="md-nav__link">
    scale_space()
  </a>
  
    <nav class="md-nav" aria-label="scale_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer" class="md-nav__link">
    space_box_min_maxer()
  </a>
  
    <nav class="md-nav" aria-label="space_box_min_maxer()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_box_into_tuple_of_discretes" class="md-nav__link">
    turn_box_into_tuple_of_discretes()
  </a>
  
    <nav class="md-nav" aria-label="turn_box_into_tuple_of_discretes()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_box_into_tuple_of_discretes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont" class="md-nav__link">
    turn_discrete_action_back_to_cont()
  </a>
  
    <nav class="md-nav" aria-label="turn_discrete_action_back_to_cont()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace" class="md-nav__link">
    turn_discrete_action_back_to_cont_powerspace()
  </a>
  
    <nav class="md-nav" aria-label="turn_discrete_action_back_to_cont_powerspace()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample" class="md-nav__link">
    turn_orig_space_box_to_cont_sample()
  </a>
  
    <nav class="md-nav" aria-label="turn_orig_space_box_to_cont_sample()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace" class="md-nav__link">
    turn_orig_space_box_to_cont_sample_powerspace()
  </a>
  
    <nav class="md-nav" aria-label="turn_orig_space_box_to_cont_sample_powerspace()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space" class="md-nav__link">
    unscale_sample_from_space()
  </a>
  
    <nav class="md-nav" aria-label="unscale_sample_from_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.zero_mean_space" class="md-nav__link">
    zero_mean_space()
  </a>
  
    <nav class="md-nav" aria-label="zero_mean_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.zero_mean_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../environment_dict/" class="md-nav__link">
        Environment dict
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../factory/" class="md-nav__link">
        Factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../functor/" class="md-nav__link">
        Functor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nan_check/" class="md-nav__link">
        Nan check
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observation_extractor/" class="md-nav__link">
        Observation extractor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../observation_util/" class="md-nav__link">
        Observation util
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../parameters/" class="md-nav__link">
        Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugin_library/" class="md-nav__link">
        Plugin library
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../property/" class="md-nav__link">
        Property
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../state_dict/" class="md-nav__link">
        State dict
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../units/" class="md-nav__link">
        Units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hparam_search_util/" class="md-nav__link">
        Hparam search util
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rllib_setup_util/" class="md-nav__link">
        Rllib setup util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_12" type="checkbox" id="__nav_7_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_12">
          Parts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Parts" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_12">
          <span class="md-nav__icon md-icon"></span>
          Parts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../parts/__init__.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../parts/memory_store.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_13" type="checkbox" id="__nav_7_13" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../parsers/__init__/">Parsers</a>
          
            <label for="__nav_7_13">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Parsers" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_13">
          <span class="md-nav__icon md-icon"></span>
          Parsers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../parsers/yaml_loader/" class="md-nav__link">
        Yaml loader
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_14" type="checkbox" id="__nav_7_14" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../policies/__init__/">Policies</a>
          
            <label for="__nav_7_14">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Policies" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_14">
          <span class="md-nav__icon md-icon"></span>
          Policies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/base_policy/" class="md-nav__link">
        Base policy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/random_action/" class="md-nav__link">
        Random action
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/scripted_action/" class="md-nav__link">
        Scripted action
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../policies/custom_policy/" class="md-nav__link">
        Custom policy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_15" type="checkbox" id="__nav_7_15" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../rewards/__init__/">Rewards</a>
          
            <label for="__nav_7_15">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Rewards" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_15">
          <span class="md-nav__icon md-icon"></span>
          Rewards
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/base_measurement_operation/" class="md-nav__link">
        Base measurement operation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/episode_done/" class="md-nav__link">
        Episode done
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/exponential_decay_from_target_value/" class="md-nav__link">
        Exponential decay from target value
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/openai_gym_reward/" class="md-nav__link">
        Openai gym reward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/reward_func_base/" class="md-nav__link">
        Reward func base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/reward_func_multi_wrapper/" class="md-nav__link">
        Reward func multi wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/reward_func_wrapper/" class="md-nav__link">
        Reward func wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/multi_measurement_operation/" class="md-nav__link">
        Multi measurement operation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/reward_func_dict_wrapper/" class="md-nav__link">
        Reward func dict wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_15_10" type="checkbox" id="__nav_7_15_10" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../rewards/docking_1d/__init__/">Docking 1D</a>
          
            <label for="__nav_7_15_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Docking 1D" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_15_10">
          <span class="md-nav__icon md-icon"></span>
          Docking 1D
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/docking_1d/docking_distance_change_reward/" class="md-nav__link">
        Docking distance change reward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rewards/docking_1d/docking_reward/" class="md-nav__link">
        Docking reward
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_16" type="checkbox" id="__nav_7_16" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../simulators/__init__/">Simulators</a>
          
            <label for="__nav_7_16">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Simulators" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_16">
          <span class="md-nav__icon md-icon"></span>
          Simulators
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/base_available_platforms/" class="md-nav__link">
        Base available platforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/base_parts/" class="md-nav__link">
        Base parts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/base_platform/" class="md-nav__link">
        Base platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/base_properties/" class="md-nav__link">
        Base properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/base_simulator/" class="md-nav__link">
        Base simulator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/common_platform_utils/" class="md-nav__link">
        Common platform utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_16_7" type="checkbox" id="__nav_7_16_7" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../simulators/openai_gym/__init__/">OpenAI Gym</a>
          
            <label for="__nav_7_16_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="OpenAI Gym" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_16_7">
          <span class="md-nav__icon md-icon"></span>
          OpenAI Gym
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/openai_gym/gym_available_platforms/" class="md-nav__link">
        Gym available platforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/openai_gym/gym_controllers/" class="md-nav__link">
        Gym controllers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/openai_gym/gym_sensors/" class="md-nav__link">
        Gym sensors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/openai_gym/gym_simulator/" class="md-nav__link">
        Gym simulator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_16_8" type="checkbox" id="__nav_7_16_8" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../simulators/six_dof/__init__/">Six DOF</a>
          
            <label for="__nav_7_16_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Six DOF" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_16_8">
          <span class="md-nav__icon md-icon"></span>
          Six DOF
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/six_dof/base_six_dof_controllers/" class="md-nav__link">
        Base six dof controllers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/six_dof/base_six_dof_platform/" class="md-nav__link">
        Base six dof platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/six_dof/base_six_dof_properties/" class="md-nav__link">
        Base six dof properties
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_16_9" type="checkbox" id="__nav_7_16_9" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../simulators/docking_1d/__init__/">Docking 1D</a>
          
            <label for="__nav_7_16_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Docking 1D" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_16_9">
          <span class="md-nav__icon md-icon"></span>
          Docking 1D
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/docking_1d/available_platforms/" class="md-nav__link">
        Available platforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/docking_1d/controllers/" class="md-nav__link">
        Controllers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/docking_1d/entities/" class="md-nav__link">
        Entities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/docking_1d/platform/" class="md-nav__link">
        Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/docking_1d/properties/" class="md-nav__link">
        Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/docking_1d/sensors/" class="md-nav__link">
        Sensors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../simulators/docking_1d/simulator/" class="md-nav__link">
        Simulator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../change_log/" class="md-nav__link">
        Change log
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util" class="md-nav__link">
    corl.libraries.env_space_util
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil" class="md-nav__link">
    EnvSpaceUtil
  </a>
  
    <nav class="md-nav" aria-label="EnvSpaceUtil">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.add_space_samples" class="md-nav__link">
    add_space_samples()
  </a>
  
    <nav class="md-nav" aria-label="add_space_samples()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.add_space_samples--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler" class="md-nav__link">
    box_scaler()
  </a>
  
    <nav class="md-nav" aria-label="box_scaler()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler" class="md-nav__link">
    box_unscaler()
  </a>
  
    <nav class="md-nav" aria-label="box_unscaler()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space" class="md-nav__link">
    clip_space_sample_to_space()
  </a>
  
    <nav class="md-nav" aria-label="clip_space_sample_to_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space" class="md-nav__link">
    convert_config_param_to_space()
  </a>
  
    <nav class="md-nav" aria-label="convert_config_param_to_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_merge_dict" class="md-nav__link">
    deep_merge_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_sanity_check_space_sample" class="md-nav__link">
    deep_sanity_check_space_sample()
  </a>
  
    <nav class="md-nav" aria-label="deep_sanity_check_space_sample()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_sanity_check_space_sample--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space" class="md-nav__link">
    get_mean_sample_from_space()
  </a>
  
    <nav class="md-nav" aria-label="get_mean_sample_from_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space" class="md-nav__link">
    get_zero_sample_from_space()
  </a>
  
    <nav class="md-nav" aria-label="get_zero_sample_from_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes" class="md-nav__link">
    iterate_over_space_likes()
  </a>
  
    <nav class="md-nav" aria-label="iterate_over_space_likes()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space" class="md-nav__link">
    normalize_space()
  </a>
  
    <nav class="md-nav" aria-label="normalize_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample" class="md-nav__link">
    sanity_check_space_sample()
  </a>
  
    <nav class="md-nav" aria-label="sanity_check_space_sample()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample--raises" class="md-nav__link">
    Raises
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space" class="md-nav__link">
    scale_sample_from_space()
  </a>
  
    <nav class="md-nav" aria-label="scale_sample_from_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_space" class="md-nav__link">
    scale_space()
  </a>
  
    <nav class="md-nav" aria-label="scale_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer" class="md-nav__link">
    space_box_min_maxer()
  </a>
  
    <nav class="md-nav" aria-label="space_box_min_maxer()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_box_into_tuple_of_discretes" class="md-nav__link">
    turn_box_into_tuple_of_discretes()
  </a>
  
    <nav class="md-nav" aria-label="turn_box_into_tuple_of_discretes()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_box_into_tuple_of_discretes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont" class="md-nav__link">
    turn_discrete_action_back_to_cont()
  </a>
  
    <nav class="md-nav" aria-label="turn_discrete_action_back_to_cont()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace" class="md-nav__link">
    turn_discrete_action_back_to_cont_powerspace()
  </a>
  
    <nav class="md-nav" aria-label="turn_discrete_action_back_to_cont_powerspace()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample" class="md-nav__link">
    turn_orig_space_box_to_cont_sample()
  </a>
  
    <nav class="md-nav" aria-label="turn_orig_space_box_to_cont_sample()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace" class="md-nav__link">
    turn_orig_space_box_to_cont_sample_powerspace()
  </a>
  
    <nav class="md-nav" aria-label="turn_orig_space_box_to_cont_sample_powerspace()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space" class="md-nav__link">
    unscale_sample_from_space()
  </a>
  
    <nav class="md-nav" aria-label="unscale_sample_from_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.zero_mean_space" class="md-nav__link">
    zero_mean_space()
  </a>
  
    <nav class="md-nav" aria-label="zero_mean_space()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corl.libraries.env_space_util.EnvSpaceUtil.zero_mean_space--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/act3-ace/CoRL/blob/main/docs/corl/libraries/env_space_util.py" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>Env space util</h1>

<div class="doc doc-object doc-module">

<a id="corl.libraries.env_space_util"></a>
    <div class="doc doc-contents first">

      <hr />
<p>Air Force Research Laboratory (AFRL) Autonomous Capabilities Team (ACT3)
Reinforcement Learning (RL) Core.</p>
<p>This is a US Government Work not subject to copyright protection in the US.</p>
<p>The use, dissemination or disclosure of data in this file is subject to
limitation or restriction. See accompanying README and LICENSE for details.</p>
<hr />
<p>ENV Space Util Module</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 id="corl.libraries.env_space_util.EnvSpaceUtil" class="doc doc-heading">
        <code>
EnvSpaceUtil        </code>



<a href="#corl.libraries.env_space_util.EnvSpaceUtil" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>ENV Space Util</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">EnvSpaceUtil</span><span class="p">:</span>  <span class="c1"># pylint: disable=R0904</span>
    <span class="sd">&quot;&quot;&quot; ENV Space Util</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;EnvSpaceUtil&quot;</span><span class="p">)</span>
    <span class="n">sample_type</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">OrderedDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">deep_sanity_check_space_sample</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0912</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
        <span class="n">sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
        <span class="n">key_stack</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Ensure space sample is consistent with space. This will give a traceback of the exact space that failed</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Dict</span>
<span class="sd">            the space we expect the sample to conform to</span>
<span class="sd">        sample: sample_type</span>
<span class="sd">            sample that we are checking if it belongs to the given space</span>
<span class="sd">        key_stack: str</span>
<span class="sd">            string of the keys we have used when getting to this current spot in the observation_space, observation</span>
<span class="sd">            this is used for recursive calls do not set in the initial call to this function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">StateDict</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> was a gym.spaces.Dict type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a StateDict, OrderedDict, or dict&quot;</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">deep_sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="n">key_stack</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.Tuple type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a tuple type&quot;</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
                <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">deep_sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="n">key_stack</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.Discrete type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not an int or np.integer or np.ndarray&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has value of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> however &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has space definition of </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.Box type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a np.ndarray, list, or np.float type&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
                <span class="n">sample_dtype</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has value of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> however &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has space definition of </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;space dtype is </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">, sample dtype is </span><span class="si">{</span><span class="n">sample_dtype</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">MultiBinary</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.MultiBinary type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a np.ndarray, list, or np.integer type&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has value of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> however &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has space definition of </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">MultiDiscrete</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.MultiDiscrete type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a np.ndarray, list, or np.integer type&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has value of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> however &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has space definition of </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">nvec</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">Repeated</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a ray.rllib.utils.spaces.repeated.Repeated type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a list  type&quot;</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
                <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">deep_sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">child_space</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">key_stack</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space : [type]</span>
<span class="sd">            [description]</span>
<span class="sd">        sample : [type]</span>
<span class="sd">            [description]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sample of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> does not meet space </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> setup&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">deep_merge_dict</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merget two dictionaries that also can contain sub dictionaries. This function returns the second dict</span>
<span class="sd">        but it also modifies it in place</span>

<span class="sd">        run me with nosetests --with-doctest file.py</span>

<span class="sd">        &gt;&gt;&gt; a = { &#39;first&#39; : { &#39;all_rows&#39; : { &#39;pass&#39; : &#39;dog&#39;, &#39;number&#39; : &#39;1&#39; } } }</span>
<span class="sd">        &gt;&gt;&gt; b = { &#39;first&#39; : { &#39;all_rows&#39; : { &#39;fail&#39; : &#39;cat&#39;, &#39;number&#39; : &#39;5&#39; } } }</span>
<span class="sd">        &gt;&gt;&gt; merge(b, a) == { &#39;first&#39; : { &#39;all_rows&#39; : { &#39;pass&#39; : &#39;dog&#39;, &#39;fail&#39; : &#39;cat&#39;, &#39;number&#39; : &#39;5&#39; } } }</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="c1"># get node or create one</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">destination</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">())</span>
                <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">deep_merge_dict</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">destination</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">destination</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">scale_space</span><span class="p">(</span><span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Multiplies the low and high properties of all the Boxes in the given gym space by the scale input</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            the gym space to scale the Boxes of</span>
<span class="sd">        scale: float</span>
<span class="sd">            what to multiply the Box low and high by</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gym.spaces.Space</span>
<span class="sd">            the scaled gym space</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: this copy probably doesn&#39;t actually work but I can dream</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">scale_space</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">spaces</span><span class="o">=</span><span class="n">new_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">new_thing</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">scale_space</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_thing</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="n">scaled_box</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
                <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
                <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
                <span class="n">shape</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span>
            <span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">scaled_box</span>

        <span class="k">return</span> <span class="n">val</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">zero_mean_space</span><span class="p">(</span><span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a space object where every Box instance has its low and high shifted to be zero mean</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            The gym space to zero mean</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gym.spaces.Space</span>
<span class="sd">            A gym space the same as the input but with the Box instances shifted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: this copy doesn&#39;t actually work but I can dream</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">zero_mean_space</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">spaces</span><span class="o">=</span><span class="n">new_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">new_thing</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">zero_mean_space</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_thing</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">high</span> <span class="o">+</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">zero_mean_box</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">low</span> <span class="o">-</span> <span class="n">mean</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">high</span> <span class="o">-</span> <span class="n">mean</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">zero_mean_box</span>

        <span class="k">return</span> <span class="n">val</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">space_box_min_maxer</span><span class="p">(</span>
        <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">],</span>
        <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes a gym box to the out_min and out_max range</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space_likes: typing.Tuple[gym.spaces.Space]</span>
<span class="sd">            the gym space to turn all boxes into the scaled space</span>
<span class="sd">        out_min: float</span>
<span class="sd">            the new low for the boxes</span>
<span class="sd">        out_max: float</span>
<span class="sd">            the new high for the boxes</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gym.spaces.Space:</span>
<span class="sd">            the new gym spaces where all boxes have had their bounds changed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">space_arg</span> <span class="o">=</span> <span class="n">space_likes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">out_min</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">out_max</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">space_arg</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_arg</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">normalize_space</span><span class="p">(</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
        <span class="n">out_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">out_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a convenience wrapper for box_scaler</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            the gym space to turn all boxes into the scaled space</span>
<span class="sd">        out_min: float</span>
<span class="sd">            the new low for the boxes</span>
<span class="sd">        out_max: float</span>
<span class="sd">            the new high for the boxes</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gym.spaces.Space:</span>
<span class="sd">            the new gym spaces where all boxes have had their bounds changed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">space_box_min_maxer</span><span class="p">,</span>
            <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="p">),</span>
            <span class="n">out_min</span><span class="o">=</span><span class="n">out_min</span><span class="p">,</span>
            <span class="n">out_max</span><span class="o">=</span><span class="n">out_max</span><span class="p">,</span>
            <span class="n">return_space</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_zero_sample_from_space</span><span class="p">(</span><span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a gym space returns an instance of that space but instead of sampling from the</span>
<span class="sd">        gym space, returns all zeros. If the space is not a Box and we cannot iterate over it</span>
<span class="sd">        then we will sample from it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            The gym space to zero sample from</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type</span>
<span class="sd">            The instance of the gym space but all Box spaces are sampled as zero</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">new_dict</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_mean_sample_from_space</span><span class="p">(</span><span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a gym space returns an instance of that space but instead of sampling from the</span>
<span class="sd">        gym space, returns all zeros. If the space is not a Box and we cannot iterate over it</span>
<span class="sd">        then we will sample from it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            The gym space to zero sample from</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type</span>
<span class="sd">            The instance of the gym space but all Box spaces are sampled as zero</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">new_dict</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">high</span> <span class="o">+</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_space_samples</span><span class="p">(</span>
        <span class="n">space_template</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
        <span class="n">space_sample1</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
        <span class="n">space_sample2</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds together two instances of gym spaces. This only adds the ndarray or list types (that were sampled from Box)</span>
<span class="sd">        If the object is not a ndarray or list then the value of space_sample1 is returned by default</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space_template: gym.spaces.Space</span>
<span class="sd">            The template to use for adding these space instances.</span>
<span class="sd">            This is to determine the difference between a Box and Discrete or MultiDiscrete or MultiBinary</span>
<span class="sd">        space_sample1: sample_type</span>
<span class="sd">            The first instance to add</span>
<span class="sd">        space_sample2: sample_type</span>
<span class="sd">            The second instance to add</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type</span>
<span class="sd">            an instance of the space object but with all the Box types added</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if not type(space_sample1) == type(space_sample2):</span>
        <span class="c1">#     raise ValueError(&#39;space instances must be of same type&#39;)</span>
        <span class="c1"># TODO: I want to check they are the same type but dict and OrderedDict should match which makes this annoying</span>
        <span class="n">val</span><span class="p">:</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">sample_type</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">space_value</span> <span class="ow">in</span> <span class="n">space_template</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">value1</span> <span class="o">=</span> <span class="n">space_sample1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">value2</span> <span class="o">=</span> <span class="n">space_sample2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">add_space_samples</span><span class="p">(</span><span class="n">space_value</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">new_dict</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">add_space_samples</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">args</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">space_sample1</span><span class="p">,</span> <span class="n">space_sample2</span><span class="p">)]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_sample1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">space_sample1</span> <span class="o">+</span> <span class="n">space_sample2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_sample1</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="p">[</span><span class="n">value1</span> <span class="o">+</span> <span class="n">value2</span> <span class="k">for</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">space_sample1</span><span class="p">,</span> <span class="n">space_sample2</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">clip_space_sample_to_space</span><span class="p">(</span><span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">is_wrap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clips a space instance to a given space. After this the space should contain the space instance</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space_sample: sample_type</span>
<span class="sd">            the space instance we are going to clip</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            the gym space to clip the instance to.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type</span>
<span class="sd">            the clipped space instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">space_value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">space_sample_value</span> <span class="o">=</span> <span class="n">space_sample</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">clip_space_sample_to_space</span><span class="p">(</span><span class="n">space_sample_value</span><span class="p">,</span> <span class="n">space_value</span><span class="p">,</span> <span class="n">is_wrap</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">new_dict</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">clip_space_sample_to_space</span><span class="p">(</span><span class="n">siv</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">is_wrap</span><span class="p">)</span> <span class="k">for</span> <span class="n">siv</span><span class="p">,</span> <span class="n">sv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">space_sample</span><span class="p">,</span> <span class="n">space</span><span class="p">)]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">is_wrap</span><span class="p">:</span>
                <span class="c1"># Takes care of the case where the controls wrap at the min/max value</span>
                <span class="c1"># Example: Range = 0-1, value = 1.1 ----&gt; clipping puts to .1</span>
                <span class="k">if</span> <span class="n">space_sample</span> <span class="o">&gt;</span> <span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span> <span class="o">+</span> <span class="p">(</span><span class="n">space_sample</span> <span class="o">-</span> <span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">space_sample</span> <span class="o">&lt;</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">high</span> <span class="o">-</span> <span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">low</span> <span class="o">-</span> <span class="n">space_sample</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Takes care of the case where the controls saturate at the min/max value</span>
                <span class="c1"># Example: Range = 0-1, value = 1.1 ----&gt; clipping puts to 1</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_sample</span><span class="p">,</span> <span class="p">(</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)),</span> \
                    <span class="sa">f</span><span class="s1">&#39;Box spaces must have sequence samples, received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">space_sample</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">space_sample</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">turn_box_into_tuple_of_discretes</span><span class="p">(</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">num_actions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes a gym space and replaces any Box types with MultiDiscrete types with the same number of</span>
<span class="sd">        possible of discrete as the box and each discrete has the same number of possible actions = num_actions</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space</span>
<span class="sd">        num_actions: int, list, dict</span>
<span class="sd">            how many discrete actions to give to each possible discrete in the MultiDiscrete</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gym.spaces.Space</span>
<span class="sd">            A gym space where all the Box types are replaced with MultiDiscrete types</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># first pass through the code num_actions is an int or list, this code turns it into an</span>
        <span class="c1"># iterator for the rest of the recursive calls</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actions</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">num_actions</span> <span class="o">=</span> <span class="n">repeat</span><span class="p">(</span><span class="n">num_actions</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actions</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">num_actions</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">num_actions</span><span class="p">)</span>

        <span class="c1"># TODO: this copy doesn&#39;t actually work but I can dream</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">space_value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_box_into_tuple_of_discretes</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">space_value</span><span class="p">,</span> <span class="n">num_actions</span><span class="o">=</span><span class="n">num_actions</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_box_into_tuple_of_discretes</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">space_value</span><span class="p">,</span> <span class="n">num_actions</span><span class="o">=</span><span class="n">num_actions</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">spaces</span><span class="o">=</span><span class="n">new_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_box_into_tuple_of_discretes</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span> <span class="n">num_actions</span><span class="o">=</span><span class="n">num_actions</span><span class="p">)</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">space</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">new_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actions</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;num_actions must be iterator, received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">num_actions</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">([</span><span class="n">Discrete</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">num_actions</span><span class="p">)))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="o">.</span><span class="n">size</span><span class="p">)])</span>

        <span class="k">return</span> <span class="n">val</span>

    <span class="c1"># TODO: maybe use this function in more places? maybe not? it could be slower?</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">iterate_over_space_likes</span><span class="p">(</span>
        <span class="n">func</span><span class="p">,</span>
        <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span>
        <span class="n">return_space</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates over space_likes which are tuple, dicts or the gym equivalent.</span>
<span class="sd">        When it encounters an actual item that is not a container it calls the func method.</span>
<span class="sd">        put any args, or kwargs you want to give to func in the overall call and they will be forwarded</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func:</span>
<span class="sd">            the function to apply</span>
<span class="sd">        space_likes: typing.Tuple[typing.Union[gym.spaces.Space, sample_type], ...]</span>
<span class="sd">            the spaces to iterate over. They must have the same keywords for dicts and number of items for tuples</span>
<span class="sd">        return_space: bool</span>
<span class="sd">            if true the containers will be gym space equivalents</span>
<span class="sd">        func_args</span>
<span class="sd">            the arguments to give to func</span>
<span class="sd">        func_kwargs</span>
<span class="sd">            the keyword arguments to give to func</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        The contained result by calling func and stuffing back into the tuples and dicts in the call</span>
<span class="sd">        if return_space=True the containers are gym spaces</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">first_space_like</span> <span class="o">=</span> <span class="n">space_likes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_space_like</span><span class="p">,</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">)):</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">keys</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">KeysView</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_space_like</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="n">first_space_like</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="n">first_space_like</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">new_space_likes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">spacer</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">spacer</span> <span class="ow">in</span> <span class="n">space_likes</span><span class="p">)</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
                    <span class="n">func</span><span class="p">,</span>
                    <span class="n">space_likes</span><span class="o">=</span><span class="n">new_space_likes</span><span class="p">,</span>
                    <span class="n">return_space</span><span class="o">=</span><span class="n">return_space</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">spaces</span><span class="o">=</span><span class="n">new_dict</span><span class="p">)</span> <span class="k">if</span> <span class="n">return_space</span> <span class="k">else</span> <span class="n">new_dict</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_space_like</span><span class="p">,</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
                    <span class="n">func</span><span class="p">,</span>
                    <span class="n">space_likes</span><span class="o">=</span><span class="n">new_space_likes</span><span class="p">,</span>
                    <span class="n">return_space</span><span class="o">=</span><span class="n">return_space</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
                <span class="p">)</span> <span class="k">for</span> <span class="n">new_space_likes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">space_likes</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">))</span> <span class="k">if</span> <span class="n">return_space</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_space_like</span><span class="p">,</span> <span class="n">Repeated</span><span class="p">):</span>
            <span class="c1"># if space_likes is longer than 1 that means that return_space = False</span>
            <span class="c1"># if there is only the space that means we need to generate just the space</span>
            <span class="c1"># itself and can use the second path, however for the case where we have a sample</span>
            <span class="c1"># it comes in as a list and we must iterate over the entire repeated list and process it</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">space_likes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">repeated_samples</span> <span class="o">=</span> <span class="n">space_likes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">repeated_samples</span><span class="p">,</span> <span class="n">MutableSequence</span><span class="p">),</span> \
                    <span class="sa">f</span><span class="s1">&#39;repeated_samples must be MutableSequence, received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">repeated_samples</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">indx</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">repeated_samples</span><span class="p">):</span>
                    <span class="n">repeated_samples</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
                        <span class="n">func</span><span class="p">,</span>
                        <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">first_space_like</span><span class="o">.</span><span class="n">child_space</span><span class="p">,</span> <span class="n">sample</span><span class="p">),</span>
                        <span class="n">return_space</span><span class="o">=</span><span class="n">return_space</span><span class="p">,</span>
                        <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">repeated_samples</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_child_space</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
                    <span class="n">func</span><span class="p">,</span>
                    <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">first_space_like</span><span class="o">.</span><span class="n">child_space</span><span class="p">,</span> <span class="p">),</span>
                    <span class="n">return_space</span><span class="o">=</span><span class="n">return_space</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">val</span> <span class="o">=</span> <span class="n">Repeated</span><span class="p">(</span><span class="n">child_space</span><span class="o">=</span><span class="n">new_child_space</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="n">first_space_like</span><span class="o">.</span><span class="n">max_len</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">space_likes</span><span class="p">,</span> <span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="n">func_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">turn_orig_space_box_to_cont_sample</span><span class="p">(</span><span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a continuous space and a discrete space and a sample of the discrete space,</span>
<span class="sd">        this function turns the discrete sample into a continuous sample</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space_likes: typing.Tuple[gym.spaces.Space, gym.spaces.Space, sample_type]</span>
<span class="sd">            the first is the original gym space that is continuous,</span>
<span class="sd">            the second is the new gym space with discrete objects</span>
<span class="sd">            the last is the space sample that is of discrete types</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type:</span>
<span class="sd">            the sample space that is now a continuous version of the discrete sample space according to the cont space</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">original_space_arg</span><span class="p">,</span> <span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">space_sample_arg</span><span class="p">)</span> <span class="o">=</span> <span class="n">space_likes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_space_arg</span><span class="p">,</span>
                      <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">MultiDiscrete</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">))):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">MultiDiscrete</span><span class="p">):</span>
                <span class="n">possible_n</span> <span class="o">=</span> <span class="n">discrete_only_space_arg</span><span class="o">.</span><span class="n">nvec</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
                <span class="n">possible_n</span> <span class="o">=</span> <span class="n">discrete_only_space_arg</span><span class="o">.</span><span class="n">n</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This should not be reachable&quot;</span><span class="p">)</span>

            <span class="n">action</span> <span class="o">=</span> <span class="n">space_sample_arg</span>
            <span class="n">low</span> <span class="o">=</span> <span class="n">original_space_arg</span><span class="o">.</span><span class="n">low</span>
            <span class="n">high</span> <span class="o">=</span> <span class="n">original_space_arg</span><span class="o">.</span><span class="n">high</span>
            <span class="n">new_cont_sample</span> <span class="o">=</span> <span class="p">(</span><span class="n">action</span> <span class="o">/</span> <span class="p">(</span><span class="n">possible_n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">+</span> <span class="n">low</span>

            <span class="k">return</span> <span class="n">new_cont_sample</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">turn_orig_space_box_to_cont_sample_powerspace</span><span class="p">(</span>
        <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a continuous space and a discrete space and a sample of the discrete space,</span>
<span class="sd">        this function turns the discrete sample into a continuous sample</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space_likes: typing.Tuple[gym.spaces.Space, gym.spaces.Space, sample_type]</span>
<span class="sd">            the first is the original gym space that is continuous,</span>
<span class="sd">            the second is the new gym space with discrete objects</span>
<span class="sd">            the last is the space sample that is of discrete types</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type:</span>
<span class="sd">            the sample space that is now a continuous version of the discrete sample space according to the cont space</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># There is a test built for this function. Please keep the test up to date for any changes you make.</span>
        <span class="p">(</span><span class="n">original_space_arg</span><span class="p">,</span> <span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">space_sample_arg</span><span class="p">,</span> <span class="n">pow_n</span><span class="p">)</span> <span class="o">=</span> <span class="n">space_likes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_space_arg</span><span class="p">,</span>
                      <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">))):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
                <span class="n">possible_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">n</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">discrete_only_space_arg</span><span class="p">])</span>
                <span class="n">pow_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pow_n</span><span class="p">)</span>
                <span class="n">discrete_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
                <span class="n">possible_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">discrete_only_space_arg</span><span class="o">.</span><span class="n">n</span><span class="p">])</span>
                <span class="n">pow_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">pow_n</span><span class="p">])</span>
                <span class="n">discrete_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">space_sample_arg</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This should not be reachable&quot;</span><span class="p">)</span>

            <span class="n">low</span> <span class="o">=</span> <span class="n">original_space_arg</span><span class="o">.</span><span class="n">low</span>
            <span class="n">high</span> <span class="o">=</span> <span class="n">original_space_arg</span><span class="o">.</span><span class="n">high</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">low</span> <span class="o">&gt;</span> <span class="n">high</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;lower bounds of space somehow higher than high bounds&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">possible_n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">pow_n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The exponential power factor not supported when possible_n % 2&quot;</span><span class="p">)</span>

                <span class="n">difference</span> <span class="o">=</span> <span class="n">high</span> <span class="o">-</span> <span class="n">low</span>
                <span class="n">movement_per_space_sample</span> <span class="o">=</span> <span class="n">difference</span> <span class="o">/</span> <span class="n">possible_n</span>

                <span class="n">new_cont_sample</span> <span class="o">=</span> <span class="n">low</span> <span class="o">+</span> <span class="p">(</span><span class="n">movement_per_space_sample</span> <span class="o">*</span> <span class="n">space_sample_arg</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">new_cont_sample</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">pow_n</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The exponential power factor used to stretch/shrink the discrete space must be greater than zero&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="o">-</span><span class="n">low</span> <span class="o">!=</span> <span class="n">high</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">low</span> <span class="o">&gt;=</span> <span class="n">high</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Currently only support symmetric space about zero for power space setup - TODO&quot;</span><span class="p">)</span>
            <span class="n">p_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">pow_n</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
            <span class="n">p_low</span> <span class="o">=</span> <span class="o">-</span><span class="n">p_high</span>  <span class="c1"># Since we have specified the space must be symetric around 0</span>
            <span class="n">new_cont_sample</span> <span class="o">=</span> <span class="p">(</span><span class="n">discrete_sample</span> <span class="o">/</span> <span class="p">(</span><span class="n">possible_n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">p_high</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span> <span class="o">+</span> <span class="n">p_low</span>
            <span class="n">new_cont_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">new_cont_sample</span><span class="p">),</span> <span class="n">pow_n</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">new_cont_sample</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">new_cont_sample</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">turn_discrete_action_back_to_cont</span><span class="p">(</span>
        <span class="n">original_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
        <span class="n">discrete_only_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
        <span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a convenience wrapper for turn_orig_space_box_to_cont_sample</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        original_space: gym.spaces.Space</span>
<span class="sd">            the continuous space</span>
<span class="sd">        discrete_only_space: gym.spaces.Space</span>
<span class="sd">            the discrete space</span>
<span class="sd">        space_sample: sample_type</span>
<span class="sd">            the sample of the discrete space</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type:</span>
<span class="sd">            the continuous version of the discrete sample</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
            <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_orig_space_box_to_cont_sample</span><span class="p">,</span>
            <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">original_space</span><span class="p">,</span> <span class="n">discrete_only_space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">),</span>
            <span class="n">return_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">turn_discrete_action_back_to_cont_powerspace</span><span class="p">(</span>
        <span class="n">original_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">discrete_only_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span> <span class="n">pow_n</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a convenience wrapper for turn_orig_space_box_to_cont_sample_powerspace</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        original_space: gym.spaces.Space</span>
<span class="sd">            the continuous space</span>
<span class="sd">        discrete_only_space: gym.spaces.Space</span>
<span class="sd">            the discrete space</span>
<span class="sd">        space_sample: sample_type</span>
<span class="sd">            the sample of the discrete space</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type:</span>
<span class="sd">            the continuous version of the discrete sample</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
            <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_orig_space_box_to_cont_sample_powerspace</span><span class="p">,</span>
            <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">original_space</span><span class="p">,</span> <span class="n">discrete_only_space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">,</span> <span class="n">pow_n</span><span class="p">),</span>
            <span class="n">return_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">box_scaler</span><span class="p">(</span>
        <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">],</span>
        <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This scales a box space to be between the out_min and out_max arguments</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space_likes: typing.Tuple[gym.spaces.Space, sample_type]</span>
<span class="sd">            the first is the gym spade to determine the input min and max</span>
<span class="sd">            the second is the sample of this space to scale</span>
<span class="sd">        out_min: float</span>
<span class="sd">            the minimum of the output scaling</span>
<span class="sd">        out_max: float</span>
<span class="sd">            the maximum of the output scaling</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type:</span>
<span class="sd">            the scaled sample with min of out_min and max of out_max</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">space_sample_arg</span><span class="p">)</span> <span class="o">=</span> <span class="n">space_likes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span> <span class="ow">and</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">is_bounded</span><span class="p">():</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">space_sample_arg</span>
            <span class="n">in_min</span> <span class="o">=</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">low</span>
            <span class="n">in_max</span> <span class="o">=</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">high</span>
            <span class="n">norm_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">out_max</span> <span class="o">-</span> <span class="n">out_min</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">in_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">in_max</span> <span class="o">-</span> <span class="n">in_min</span><span class="p">)</span> <span class="o">+</span> <span class="n">out_min</span>
            <span class="k">return</span> <span class="n">norm_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">scale_sample_from_space</span><span class="p">(</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
        <span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
        <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a convenience wrapper for box_scaler</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            the space to use for the input min and max</span>
<span class="sd">        space_sample: sample_type</span>
<span class="sd">            the space sample to scale</span>
<span class="sd">        out_min: float</span>
<span class="sd">            the minimum of the output scaling</span>
<span class="sd">        out_max: float</span>
<span class="sd">            the maximum of the output scaling</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type:</span>
<span class="sd">            the scaled sample with min of out_min and max of</span>
<span class="sd">            out_max (this is in dicts and tuples the same as space_sample was)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">box_scaler</span><span class="p">,</span>
            <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">),</span>
            <span class="n">out_min</span><span class="o">=</span><span class="n">out_min</span><span class="p">,</span>
            <span class="n">out_max</span><span class="o">=</span><span class="n">out_max</span><span class="p">,</span>
            <span class="n">return_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">box_unscaler</span><span class="p">(</span>
        <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">],</span>
        <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unscales the space_sample according to be the scale of the input space.</span>
<span class="sd">        In this sense out_min and out_max are the min max of the sample</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space_likes: typing.Tuple[gym.spaces.Space, sample_type]</span>
<span class="sd">            the first is the gym spade to determine the input min and max</span>
<span class="sd">            the second is the sample of this space to scale</span>
<span class="sd">        out_min: float</span>
<span class="sd">            the minimum of the sample</span>
<span class="sd">        out_max: float</span>
<span class="sd">            the maximum of the sample</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        space_type:</span>
<span class="sd">            the unscaled sample</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">space_sample_arg</span><span class="p">)</span> <span class="o">=</span> <span class="n">space_likes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
            <span class="n">norm_value</span> <span class="o">=</span> <span class="n">space_sample_arg</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">norm_value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;norm_value must be np.ndarray, received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">norm_value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">in_min</span> <span class="o">=</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">low</span>
            <span class="n">in_max</span> <span class="o">=</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">high</span>
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">norm_value</span> <span class="o">-</span> <span class="n">out_min</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">in_max</span> <span class="o">-</span> <span class="n">in_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">out_max</span> <span class="o">-</span> <span class="n">out_min</span><span class="p">)</span> <span class="o">+</span> <span class="n">in_min</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">unscale_sample_from_space</span><span class="p">(</span>
        <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
        <span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
        <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a convenience wrapper for box_unscaler</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            the gym space we will unscale to</span>
<span class="sd">        space_sample: sample_type</span>
<span class="sd">            the sample we want to unscale. thus this is a scaled version of the input space</span>
<span class="sd">            with a min,max defined by the arguments out_min,out_max</span>
<span class="sd">        out_min: float</span>
<span class="sd">            the minimum of the sample</span>
<span class="sd">        out_max: float</span>
<span class="sd">            the maximum of the sample</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sample_type:</span>
<span class="sd">            the unscaled version of the space_sample. Thus the space should now contain this output sample</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">box_unscaler</span><span class="p">,</span>
            <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">),</span>
            <span class="n">out_min</span><span class="o">=</span><span class="n">out_min</span><span class="p">,</span>
            <span class="n">out_max</span><span class="o">=</span><span class="n">out_max</span><span class="p">,</span>
            <span class="n">return_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">convert_config_param_to_space</span><span class="p">(</span><span class="n">action_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a a convert for parameters used in action space conversions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        space: gym.spaces.Space</span>
<span class="sd">            the gym space that defines the actions</span>
<span class="sd">        parameter: typing.Union[int, float, list, dict]</span>
<span class="sd">            the parameter as defined in a a config</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict:</span>
<span class="sd">            actions are dicts, the output is a dict with the parameters set for each key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">action_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sample_action</span> <span class="o">=</span> <span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">parameter</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameter</span><span class="p">]</span>  <span class="c1"># change to list if needed</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># if length 1, broadcast to the proper length</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample_action</span><span class="p">:</span>
                    <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameter</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_action</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;list configs can only be applied to action space dicts with single key: </span><span class="si">{</span><span class="n">sample_action</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample_action</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;config length does not match action length of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameter</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>  <span class="c1"># pylint: disable=too-many-nested-blocks</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample_action</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameter</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>  <span class="c1"># parameters may be specfied using tuple values as keys</span>
                        <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>  <span class="c1"># type: ignore[assignment]</span>
                        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">sub_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameter</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action space key not in config key: </span><span class="si">{</span><span class="n">sub_key</span><span class="si">}</span><span class="s2">, config: </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
                            <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="n">sub_key</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action space key not in config key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">, config: </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="n">key</span><span class="p">]):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;config value length for key </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> does not match action length of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">action_params</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.add_space_samples" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_space_samples</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">space_sample1</span><span class="p">,</span> <span class="n">space_sample2</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.add_space_samples" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Adds together two instances of gym spaces. This only adds the ndarray or list types (that were sampled from Box)
If the object is not a ndarray or list then the value of space_sample1 is returned by default
Parameters</p>
<hr />
<div class="admonition space_template">
<p class="admonition-title">gym.spaces.Space</p>
<p>The template to use for adding these space instances.
This is to determine the difference between a Box and Discrete or MultiDiscrete or MultiBinary</p>
</div>
<div class="admonition space_sample1">
<p class="admonition-title">sample_type</p>
<p>The first instance to add</p>
</div>
<div class="admonition space_sample2">
<p class="admonition-title">sample_type</p>
<p>The second instance to add</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.add_space_samples--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.add_space_samples--returns" title="Permanent link"></a></h5>
<p>sample_type
    an instance of the space object but with all the Box types added</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">add_space_samples</span><span class="p">(</span>
    <span class="n">space_template</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
    <span class="n">space_sample1</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
    <span class="n">space_sample2</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds together two instances of gym spaces. This only adds the ndarray or list types (that were sampled from Box)</span>
<span class="sd">    If the object is not a ndarray or list then the value of space_sample1 is returned by default</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space_template: gym.spaces.Space</span>
<span class="sd">        The template to use for adding these space instances.</span>
<span class="sd">        This is to determine the difference between a Box and Discrete or MultiDiscrete or MultiBinary</span>
<span class="sd">    space_sample1: sample_type</span>
<span class="sd">        The first instance to add</span>
<span class="sd">    space_sample2: sample_type</span>
<span class="sd">        The second instance to add</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type</span>
<span class="sd">        an instance of the space object but with all the Box types added</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if not type(space_sample1) == type(space_sample2):</span>
    <span class="c1">#     raise ValueError(&#39;space instances must be of same type&#39;)</span>
    <span class="c1"># TODO: I want to check they are the same type but dict and OrderedDict should match which makes this annoying</span>
    <span class="n">val</span><span class="p">:</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">sample_type</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">space_value</span> <span class="ow">in</span> <span class="n">space_template</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">value1</span> <span class="o">=</span> <span class="n">space_sample1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">value2</span> <span class="o">=</span> <span class="n">space_sample2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">add_space_samples</span><span class="p">(</span><span class="n">space_value</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">new_dict</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
        <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">add_space_samples</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">args</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">space_sample1</span><span class="p">,</span> <span class="n">space_sample2</span><span class="p">)]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_template</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_sample1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">space_sample1</span> <span class="o">+</span> <span class="n">space_sample2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_sample1</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="p">[</span><span class="n">value1</span> <span class="o">+</span> <span class="n">value2</span> <span class="k">for</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">space_sample1</span><span class="p">,</span> <span class="n">space_sample2</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.box_scaler" class="doc doc-heading">
<code class="highlight language-python"><span class="n">box_scaler</span><span class="p">(</span><span class="n">space_likes</span><span class="p">,</span> <span class="n">out_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_max</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>This scales a box space to be between the out_min and out_max arguments</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.box_scaler--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler--parameters" title="Permanent link"></a></h5>
<div class="admonition space_likes">
<p class="admonition-title">typing.Tuple[gym.spaces.Space, sample_type]</p>
<p>the first is the gym spade to determine the input min and max
the second is the sample of this space to scale</p>
</div>
<div class="admonition out_min">
<p class="admonition-title">float</p>
<p>the minimum of the output scaling</p>
</div>
<div class="admonition out_max">
<p class="admonition-title">float</p>
<p>the maximum of the output scaling</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.box_scaler--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.box_scaler--returns" title="Permanent link"></a></h5>
<div class="admonition sample_type">
<p class="admonition-title">Sample_type</p>
<p>the scaled sample with min of out_min and max of out_max</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">box_scaler</span><span class="p">(</span>
    <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">],</span>
    <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This scales a box space to be between the out_min and out_max arguments</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space_likes: typing.Tuple[gym.spaces.Space, sample_type]</span>
<span class="sd">        the first is the gym spade to determine the input min and max</span>
<span class="sd">        the second is the sample of this space to scale</span>
<span class="sd">    out_min: float</span>
<span class="sd">        the minimum of the output scaling</span>
<span class="sd">    out_max: float</span>
<span class="sd">        the maximum of the output scaling</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type:</span>
<span class="sd">        the scaled sample with min of out_min and max of out_max</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">space_sample_arg</span><span class="p">)</span> <span class="o">=</span> <span class="n">space_likes</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span> <span class="ow">and</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">is_bounded</span><span class="p">():</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">space_sample_arg</span>
        <span class="n">in_min</span> <span class="o">=</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">low</span>
        <span class="n">in_max</span> <span class="o">=</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">high</span>
        <span class="n">norm_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">out_max</span> <span class="o">-</span> <span class="n">out_min</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">in_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">in_max</span> <span class="o">-</span> <span class="n">in_min</span><span class="p">)</span> <span class="o">+</span> <span class="n">out_min</span>
        <span class="k">return</span> <span class="n">norm_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler" class="doc doc-heading">
<code class="highlight language-python"><span class="n">box_unscaler</span><span class="p">(</span><span class="n">space_likes</span><span class="p">,</span> <span class="n">out_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_max</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Unscales the space_sample according to be the scale of the input space.
In this sense out_min and out_max are the min max of the sample</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler--parameters" title="Permanent link"></a></h5>
<div class="admonition space_likes">
<p class="admonition-title">typing.Tuple[gym.spaces.Space, sample_type]</p>
<p>the first is the gym spade to determine the input min and max
the second is the sample of this space to scale</p>
</div>
<div class="admonition out_min">
<p class="admonition-title">float</p>
<p>the minimum of the sample</p>
</div>
<div class="admonition out_max">
<p class="admonition-title">float</p>
<p>the maximum of the sample</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.box_unscaler--returns" title="Permanent link"></a></h5>
<div class="admonition space_type">
<p class="admonition-title">Space_type</p>
<p>the unscaled sample</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">box_unscaler</span><span class="p">(</span>
    <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">],</span>
    <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unscales the space_sample according to be the scale of the input space.</span>
<span class="sd">    In this sense out_min and out_max are the min max of the sample</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space_likes: typing.Tuple[gym.spaces.Space, sample_type]</span>
<span class="sd">        the first is the gym spade to determine the input min and max</span>
<span class="sd">        the second is the sample of this space to scale</span>
<span class="sd">    out_min: float</span>
<span class="sd">        the minimum of the sample</span>
<span class="sd">    out_max: float</span>
<span class="sd">        the maximum of the sample</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    space_type:</span>
<span class="sd">        the unscaled sample</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">space_sample_arg</span><span class="p">)</span> <span class="o">=</span> <span class="n">space_likes</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="n">norm_value</span> <span class="o">=</span> <span class="n">space_sample_arg</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">norm_value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;norm_value must be np.ndarray, received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">norm_value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">in_min</span> <span class="o">=</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">low</span>
        <span class="n">in_max</span> <span class="o">=</span> <span class="n">space_arg</span><span class="o">.</span><span class="n">high</span>
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">norm_value</span> <span class="o">-</span> <span class="n">out_min</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">in_max</span> <span class="o">-</span> <span class="n">in_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">out_max</span> <span class="o">-</span> <span class="n">out_min</span><span class="p">)</span> <span class="o">+</span> <span class="n">in_min</span>
        <span class="k">return</span> <span class="n">val</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clip_space_sample_to_space</span><span class="p">(</span><span class="n">space_sample</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">is_wrap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Clips a space instance to a given space. After this the space should contain the space instance</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space--parameters" title="Permanent link"></a></h5>
<div class="admonition space_sample">
<p class="admonition-title">sample_type</p>
<p>the space instance we are going to clip</p>
</div>
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the gym space to clip the instance to.</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.clip_space_sample_to_space--returns" title="Permanent link"></a></h5>
<p>sample_type
    the clipped space instance</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">clip_space_sample_to_space</span><span class="p">(</span><span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">is_wrap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clips a space instance to a given space. After this the space should contain the space instance</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space_sample: sample_type</span>
<span class="sd">        the space instance we are going to clip</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        the gym space to clip the instance to.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type</span>
<span class="sd">        the clipped space instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">space_value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">space_sample_value</span> <span class="o">=</span> <span class="n">space_sample</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">clip_space_sample_to_space</span><span class="p">(</span><span class="n">space_sample_value</span><span class="p">,</span> <span class="n">space_value</span><span class="p">,</span> <span class="n">is_wrap</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">new_dict</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
        <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">clip_space_sample_to_space</span><span class="p">(</span><span class="n">siv</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">is_wrap</span><span class="p">)</span> <span class="k">for</span> <span class="n">siv</span><span class="p">,</span> <span class="n">sv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">space_sample</span><span class="p">,</span> <span class="n">space</span><span class="p">)]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_wrap</span><span class="p">:</span>
            <span class="c1"># Takes care of the case where the controls wrap at the min/max value</span>
            <span class="c1"># Example: Range = 0-1, value = 1.1 ----&gt; clipping puts to .1</span>
            <span class="k">if</span> <span class="n">space_sample</span> <span class="o">&gt;</span> <span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span> <span class="o">+</span> <span class="p">(</span><span class="n">space_sample</span> <span class="o">-</span> <span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">space_sample</span> <span class="o">&lt;</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">high</span> <span class="o">-</span> <span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">low</span> <span class="o">-</span> <span class="n">space_sample</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Takes care of the case where the controls saturate at the min/max value</span>
            <span class="c1"># Example: Range = 0-1, value = 1.1 ----&gt; clipping puts to 1</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_sample</span><span class="p">,</span> <span class="p">(</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)),</span> \
                <span class="sa">f</span><span class="s1">&#39;Box spaces must have sequence samples, received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">space_sample</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">space_sample</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">convert_config_param_to_space</span><span class="p">(</span><span class="n">action_space</span><span class="p">,</span> <span class="n">parameter</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>This is a a convert for parameters used in action space conversions</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space--parameters" title="Permanent link"></a></h5>
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the gym space that defines the actions</p>
</div>
<div class="admonition parameter">
<p class="admonition-title">typing.Union[int, float, list, dict]</p>
<p>the parameter as defined in a a config</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.convert_config_param_to_space--returns" title="Permanent link"></a></h5>
<div class="admonition dict">
<p class="admonition-title">Dict</p>
<p>actions are dicts, the output is a dict with the parameters set for each key</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">convert_config_param_to_space</span><span class="p">(</span><span class="n">action_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a a convert for parameters used in action space conversions</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        the gym space that defines the actions</span>
<span class="sd">    parameter: typing.Union[int, float, list, dict]</span>
<span class="sd">        the parameter as defined in a a config</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict:</span>
<span class="sd">        actions are dicts, the output is a dict with the parameters set for each key</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">action_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">sample_action</span> <span class="o">=</span> <span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameter</span><span class="p">]</span>  <span class="c1"># change to list if needed</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># if length 1, broadcast to the proper length</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample_action</span><span class="p">:</span>
                <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameter</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_action</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;list configs can only be applied to action space dicts with single key: </span><span class="si">{</span><span class="n">sample_action</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample_action</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;config length does not match action length of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameter</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>  <span class="c1"># pylint: disable=too-many-nested-blocks</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample_action</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameter</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>  <span class="c1"># parameters may be specfied using tuple values as keys</span>
                    <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>  <span class="c1"># type: ignore[assignment]</span>
                    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">sub_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameter</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action space key not in config key: </span><span class="si">{</span><span class="n">sub_key</span><span class="si">}</span><span class="s2">, config: </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
                        <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="n">sub_key</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action space key not in config key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">, config: </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="n">key</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;config value length for key </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> does not match action length of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">action_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameter</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">action_params</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.deep_merge_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deep_merge_dict</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_merge_dict" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Merget two dictionaries that also can contain sub dictionaries. This function returns the second dict
but it also modifies it in place</p>
<p>run me with nosetests --with-doctest file.py</p>
<blockquote>
<blockquote>
<blockquote>
<p>a = { 'first' : { 'all_rows' : { 'pass' : 'dog', 'number' : '1' } } }
b = { 'first' : { 'all_rows' : { 'fail' : 'cat', 'number' : '5' } } }
merge(b, a) == { 'first' : { 'all_rows' : { 'pass' : 'dog', 'fail' : 'cat', 'number' : '5' } } }
True</p>
</blockquote>
</blockquote>
</blockquote>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">deep_merge_dict</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merget two dictionaries that also can contain sub dictionaries. This function returns the second dict</span>
<span class="sd">    but it also modifies it in place</span>

<span class="sd">    run me with nosetests --with-doctest file.py</span>

<span class="sd">    &gt;&gt;&gt; a = { &#39;first&#39; : { &#39;all_rows&#39; : { &#39;pass&#39; : &#39;dog&#39;, &#39;number&#39; : &#39;1&#39; } } }</span>
<span class="sd">    &gt;&gt;&gt; b = { &#39;first&#39; : { &#39;all_rows&#39; : { &#39;fail&#39; : &#39;cat&#39;, &#39;number&#39; : &#39;5&#39; } } }</span>
<span class="sd">    &gt;&gt;&gt; merge(b, a) == { &#39;first&#39; : { &#39;all_rows&#39; : { &#39;pass&#39; : &#39;dog&#39;, &#39;fail&#39; : &#39;cat&#39;, &#39;number&#39; : &#39;5&#39; } } }</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># get node or create one</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">destination</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">())</span>
            <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">deep_merge_dict</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">destination</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">destination</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.deep_sanity_check_space_sample" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deep_sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">key_stack</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_sanity_check_space_sample" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Ensure space sample is consistent with space. This will give a traceback of the exact space that failed</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.deep_sanity_check_space_sample--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.deep_sanity_check_space_sample--parameters" title="Permanent link"></a></h5>
<div class="admonition space">
<p class="admonition-title">gym.spaces.Dict</p>
<p>the space we expect the sample to conform to</p>
</div>
<div class="admonition sample">
<p class="admonition-title">sample_type</p>
<p>sample that we are checking if it belongs to the given space</p>
</div>
<div class="admonition key_stack">
<p class="admonition-title">str</p>
<p>string of the keys we have used when getting to this current spot in the observation_space, observation
this is used for recursive calls do not set in the initial call to this function</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">deep_sanity_check_space_sample</span><span class="p">(</span>  <span class="c1"># pylint: disable=R0912</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
    <span class="n">sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
    <span class="n">key_stack</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Ensure space sample is consistent with space. This will give a traceback of the exact space that failed</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Dict</span>
<span class="sd">        the space we expect the sample to conform to</span>
<span class="sd">    sample: sample_type</span>
<span class="sd">        sample that we are checking if it belongs to the given space</span>
<span class="sd">    key_stack: str</span>
<span class="sd">        string of the keys we have used when getting to this current spot in the observation_space, observation</span>
<span class="sd">        this is used for recursive calls do not set in the initial call to this function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">StateDict</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> was a gym.spaces.Dict type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a StateDict, OrderedDict, or dict&quot;</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">deep_sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="n">key_stack</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.Tuple type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a tuple type&quot;</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
            <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">deep_sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="n">key_stack</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.Discrete type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not an int or np.integer or np.ndarray&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has value of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> however &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has space definition of </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.Box type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a np.ndarray, list, or np.float type&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
            <span class="n">sample_dtype</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has value of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> however &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has space definition of </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;space dtype is </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">, sample dtype is </span><span class="si">{</span><span class="n">sample_dtype</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">MultiBinary</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.MultiBinary type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a np.ndarray, list, or np.integer type&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has value of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> however &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has space definition of </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">MultiDiscrete</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a gym.spaces.MultiDiscrete type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a np.ndarray, list, or np.integer type&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has value of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> however &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2"> has space definition of </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">space</span><span class="o">.</span><span class="n">nvec</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">Repeated</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;space</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> is a ray.rllib.utils.spaces.repeated.Repeated type but</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;sample</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="si">}</span><span class="s2"> type and not a list  type&quot;</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
            <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">deep_sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">child_space</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">key_stack</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key_stack</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_mean_sample_from_space</span><span class="p">(</span><span class="n">space</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Given a gym space returns an instance of that space but instead of sampling from the
gym space, returns all zeros. If the space is not a Box and we cannot iterate over it
then we will sample from it.</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space--parameters" title="Permanent link"></a></h5>
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>The gym space to zero sample from</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.get_mean_sample_from_space--returns" title="Permanent link"></a></h5>
<p>sample_type
    The instance of the gym space but all Box spaces are sampled as zero</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_mean_sample_from_space</span><span class="p">(</span><span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a gym space returns an instance of that space but instead of sampling from the</span>
<span class="sd">    gym space, returns all zeros. If the space is not a Box and we cannot iterate over it</span>
<span class="sd">    then we will sample from it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        The gym space to zero sample from</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type</span>
<span class="sd">        The instance of the gym space but all Box spaces are sampled as zero</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">new_dict</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
        <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">high</span> <span class="o">+</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">space</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Given a gym space returns an instance of that space but instead of sampling from the
gym space, returns all zeros. If the space is not a Box and we cannot iterate over it
then we will sample from it.</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space--parameters" title="Permanent link"></a></h5>
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>The gym space to zero sample from</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.get_zero_sample_from_space--returns" title="Permanent link"></a></h5>
<p>sample_type
    The instance of the gym space but all Box spaces are sampled as zero</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_zero_sample_from_space</span><span class="p">(</span><span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a gym space returns an instance of that space but instead of sampling from the</span>
<span class="sd">    gym space, returns all zeros. If the space is not a Box and we cannot iterate over it</span>
<span class="sd">    then we will sample from it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        The gym space to zero sample from</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type</span>
<span class="sd">        The instance of the gym space but all Box spaces are sampled as zero</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">new_dict</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
        <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">get_zero_sample_from_space</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iterate_over_space_likes</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">space_likes</span><span class="p">,</span> <span class="n">return_space</span><span class="p">,</span> <span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="n">func_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Iterates over space_likes which are tuple, dicts or the gym equivalent.
When it encounters an actual item that is not a container it calls the func method.
put any args, or kwargs you want to give to func in the overall call and they will be forwarded</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes--parameters" title="Permanent link"></a></h5>
<div class="admonition func">
<p class="admonition-title">Func</p>
<p>the function to apply</p>
</div>
<div class="admonition space_likes">
<p class="admonition-title">typing.Tuple[typing.Union[gym.spaces.Space, sample_type], ...]</p>
<p>the spaces to iterate over. They must have the same keywords for dicts and number of items for tuples</p>
</div>
<div class="admonition return_space">
<p class="admonition-title">bool</p>
<p>if true the containers will be gym space equivalents</p>
</div>
<p>func_args
    the arguments to give to func
func_kwargs
    the keyword arguments to give to func</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.iterate_over_space_likes--returns" title="Permanent link"></a></h5>
<p>The contained result by calling func and stuffing back into the tuples and dicts in the call
if return_space=True the containers are gym spaces</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">iterate_over_space_likes</span><span class="p">(</span>
    <span class="n">func</span><span class="p">,</span>
    <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">return_space</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterates over space_likes which are tuple, dicts or the gym equivalent.</span>
<span class="sd">    When it encounters an actual item that is not a container it calls the func method.</span>
<span class="sd">    put any args, or kwargs you want to give to func in the overall call and they will be forwarded</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    func:</span>
<span class="sd">        the function to apply</span>
<span class="sd">    space_likes: typing.Tuple[typing.Union[gym.spaces.Space, sample_type], ...]</span>
<span class="sd">        the spaces to iterate over. They must have the same keywords for dicts and number of items for tuples</span>
<span class="sd">    return_space: bool</span>
<span class="sd">        if true the containers will be gym space equivalents</span>
<span class="sd">    func_args</span>
<span class="sd">        the arguments to give to func</span>
<span class="sd">    func_kwargs</span>
<span class="sd">        the keyword arguments to give to func</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    The contained result by calling func and stuffing back into the tuples and dicts in the call</span>
<span class="sd">    if return_space=True the containers are gym spaces</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">first_space_like</span> <span class="o">=</span> <span class="n">space_likes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">val</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_space_like</span><span class="p">,</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">)):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">keys</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">KeysView</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_space_like</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="n">first_space_like</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="n">first_space_like</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">new_space_likes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">spacer</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">spacer</span> <span class="ow">in</span> <span class="n">space_likes</span><span class="p">)</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
                <span class="n">func</span><span class="p">,</span>
                <span class="n">space_likes</span><span class="o">=</span><span class="n">new_space_likes</span><span class="p">,</span>
                <span class="n">return_space</span><span class="o">=</span><span class="n">return_space</span><span class="p">,</span>
                <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">spaces</span><span class="o">=</span><span class="n">new_dict</span><span class="p">)</span> <span class="k">if</span> <span class="n">return_space</span> <span class="k">else</span> <span class="n">new_dict</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_space_like</span><span class="p">,</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
                <span class="n">func</span><span class="p">,</span>
                <span class="n">space_likes</span><span class="o">=</span><span class="n">new_space_likes</span><span class="p">,</span>
                <span class="n">return_space</span><span class="o">=</span><span class="n">return_space</span><span class="p">,</span>
                <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">new_space_likes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">space_likes</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">))</span> <span class="k">if</span> <span class="n">return_space</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_space_like</span><span class="p">,</span> <span class="n">Repeated</span><span class="p">):</span>
        <span class="c1"># if space_likes is longer than 1 that means that return_space = False</span>
        <span class="c1"># if there is only the space that means we need to generate just the space</span>
        <span class="c1"># itself and can use the second path, however for the case where we have a sample</span>
        <span class="c1"># it comes in as a list and we must iterate over the entire repeated list and process it</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">space_likes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">repeated_samples</span> <span class="o">=</span> <span class="n">space_likes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">repeated_samples</span><span class="p">,</span> <span class="n">MutableSequence</span><span class="p">),</span> \
                <span class="sa">f</span><span class="s1">&#39;repeated_samples must be MutableSequence, received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">repeated_samples</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">indx</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">repeated_samples</span><span class="p">):</span>
                <span class="n">repeated_samples</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
                    <span class="n">func</span><span class="p">,</span>
                    <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">first_space_like</span><span class="o">.</span><span class="n">child_space</span><span class="p">,</span> <span class="n">sample</span><span class="p">),</span>
                    <span class="n">return_space</span><span class="o">=</span><span class="n">return_space</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">repeated_samples</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_child_space</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
                <span class="n">func</span><span class="p">,</span>
                <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">first_space_like</span><span class="o">.</span><span class="n">child_space</span><span class="p">,</span> <span class="p">),</span>
                <span class="n">return_space</span><span class="o">=</span><span class="n">return_space</span><span class="p">,</span>
                <span class="o">*</span><span class="n">func_args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">func_kwargs</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">val</span> <span class="o">=</span> <span class="n">Repeated</span><span class="p">(</span><span class="n">child_space</span><span class="o">=</span><span class="n">new_child_space</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="n">first_space_like</span><span class="o">.</span><span class="n">max_len</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">space_likes</span><span class="p">,</span> <span class="o">*</span><span class="n">func_args</span><span class="p">,</span> <span class="o">**</span><span class="n">func_kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.normalize_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">normalize_space</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">out_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_max</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>This is a convenience wrapper for box_scaler</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.normalize_space--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space--parameters" title="Permanent link"></a></h5>
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the gym space to turn all boxes into the scaled space</p>
</div>
<div class="admonition out_min">
<p class="admonition-title">float</p>
<p>the new low for the boxes</p>
</div>
<div class="admonition out_max">
<p class="admonition-title">float</p>
<p>the new high for the boxes</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.normalize_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.normalize_space--returns" title="Permanent link"></a></h5>
<p>gym.spaces.Space:
    the new gym spaces where all boxes have had their bounds changed</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">normalize_space</span><span class="p">(</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
    <span class="n">out_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a convenience wrapper for box_scaler</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        the gym space to turn all boxes into the scaled space</span>
<span class="sd">    out_min: float</span>
<span class="sd">        the new low for the boxes</span>
<span class="sd">    out_max: float</span>
<span class="sd">        the new high for the boxes</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gym.spaces.Space:</span>
<span class="sd">        the new gym spaces where all boxes have had their bounds changed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">space_box_min_maxer</span><span class="p">,</span>
        <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">out_min</span><span class="o">=</span><span class="n">out_min</span><span class="p">,</span>
        <span class="n">out_max</span><span class="o">=</span><span class="n">out_max</span><span class="p">,</span>
        <span class="n">return_space</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>[summary]</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample--parameters" title="Permanent link"></a></h5>
<p>space : [type]
    [description]
sample : [type]
    [description]</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample--raises">Raises<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.sanity_check_space_sample--raises" title="Permanent link"></a></h5>
<p>RuntimeError
    [description]</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">sanity_check_space_sample</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;[summary]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space : [type]</span>
<span class="sd">        [description]</span>
<span class="sd">    sample : [type]</span>
<span class="sd">        [description]</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    RuntimeError</span>
<span class="sd">        [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sample of </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2"> does not meet space </span><span class="si">{</span><span class="n">space</span><span class="si">}</span><span class="s2"> setup&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scale_sample_from_space</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">,</span> <span class="n">out_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_max</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>This is a convenience wrapper for box_scaler</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space--parameters" title="Permanent link"></a></h5>
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the space to use for the input min and max</p>
</div>
<div class="admonition space_sample">
<p class="admonition-title">sample_type</p>
<p>the space sample to scale</p>
</div>
<div class="admonition out_min">
<p class="admonition-title">float</p>
<p>the minimum of the output scaling</p>
</div>
<div class="admonition out_max">
<p class="admonition-title">float</p>
<p>the maximum of the output scaling</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_sample_from_space--returns" title="Permanent link"></a></h5>
<div class="admonition sample_type">
<p class="admonition-title">Sample_type</p>
<p>the scaled sample with min of out_min and max of
out_max (this is in dicts and tuples the same as space_sample was)</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">scale_sample_from_space</span><span class="p">(</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
    <span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
    <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a convenience wrapper for box_scaler</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        the space to use for the input min and max</span>
<span class="sd">    space_sample: sample_type</span>
<span class="sd">        the space sample to scale</span>
<span class="sd">    out_min: float</span>
<span class="sd">        the minimum of the output scaling</span>
<span class="sd">    out_max: float</span>
<span class="sd">        the maximum of the output scaling</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type:</span>
<span class="sd">        the scaled sample with min of out_min and max of</span>
<span class="sd">        out_max (this is in dicts and tuples the same as space_sample was)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">box_scaler</span><span class="p">,</span>
        <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">),</span>
        <span class="n">out_min</span><span class="o">=</span><span class="n">out_min</span><span class="p">,</span>
        <span class="n">out_max</span><span class="o">=</span><span class="n">out_max</span><span class="p">,</span>
        <span class="n">return_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.scale_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scale_space</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Multiplies the low and high properties of all the Boxes in the given gym space by the scale input
Parameters</p>
<hr />
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the gym space to scale the Boxes of</p>
</div>
<div class="admonition scale">
<p class="admonition-title">float</p>
<p>what to multiply the Box low and high by</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.scale_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.scale_space--returns" title="Permanent link"></a></h5>
<p>gym.spaces.Space
    the scaled gym space</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">scale_space</span><span class="p">(</span><span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Multiplies the low and high properties of all the Boxes in the given gym space by the scale input</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        the gym space to scale the Boxes of</span>
<span class="sd">    scale: float</span>
<span class="sd">        what to multiply the Box low and high by</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gym.spaces.Space</span>
<span class="sd">        the scaled gym space</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: this copy probably doesn&#39;t actually work but I can dream</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">scale_space</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">spaces</span><span class="o">=</span><span class="n">new_dict</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
        <span class="n">new_thing</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">scale_space</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_thing</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="n">scaled_box</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
            <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
            <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
            <span class="n">shape</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span>
        <span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">scaled_box</span>

    <span class="k">return</span> <span class="n">val</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">space_box_min_maxer</span><span class="p">(</span><span class="n">space_likes</span><span class="p">,</span> <span class="n">out_min</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">out_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Makes a gym box to the out_min and out_max range</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer--parameters" title="Permanent link"></a></h5>
<div class="admonition space_likes">
<p class="admonition-title">typing.Tuple[gym.spaces.Space]</p>
<p>the gym space to turn all boxes into the scaled space</p>
</div>
<div class="admonition out_min">
<p class="admonition-title">float</p>
<p>the new low for the boxes</p>
</div>
<div class="admonition out_max">
<p class="admonition-title">float</p>
<p>the new high for the boxes</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.space_box_min_maxer--returns" title="Permanent link"></a></h5>
<p>gym.spaces.Space:
    the new gym spaces where all boxes have had their bounds changed</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">space_box_min_maxer</span><span class="p">(</span>
    <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">],</span>
    <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes a gym box to the out_min and out_max range</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space_likes: typing.Tuple[gym.spaces.Space]</span>
<span class="sd">        the gym space to turn all boxes into the scaled space</span>
<span class="sd">    out_min: float</span>
<span class="sd">        the new low for the boxes</span>
<span class="sd">    out_max: float</span>
<span class="sd">        the new high for the boxes</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gym.spaces.Space:</span>
<span class="sd">        the new gym spaces where all boxes have had their bounds changed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">space_arg</span> <span class="o">=</span> <span class="n">space_likes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">out_min</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">out_max</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">space_arg</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_arg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_box_into_tuple_of_discretes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">turn_box_into_tuple_of_discretes</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">num_actions</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_box_into_tuple_of_discretes" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Takes a gym space and replaces any Box types with MultiDiscrete types with the same number of
possible of discrete as the box and each discrete has the same number of possible actions = num_actions
Parameters</p>
<hr />
<p>space</p>
<div class="admonition num_actions">
<p class="admonition-title">int, list, dict</p>
<p>how many discrete actions to give to each possible discrete in the MultiDiscrete</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_box_into_tuple_of_discretes--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_box_into_tuple_of_discretes--returns" title="Permanent link"></a></h5>
<p>gym.spaces.Space
    A gym space where all the Box types are replaced with MultiDiscrete types</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">turn_box_into_tuple_of_discretes</span><span class="p">(</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">num_actions</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a gym space and replaces any Box types with MultiDiscrete types with the same number of</span>
<span class="sd">    possible of discrete as the box and each discrete has the same number of possible actions = num_actions</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space</span>
<span class="sd">    num_actions: int, list, dict</span>
<span class="sd">        how many discrete actions to give to each possible discrete in the MultiDiscrete</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gym.spaces.Space</span>
<span class="sd">        A gym space where all the Box types are replaced with MultiDiscrete types</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># first pass through the code num_actions is an int or list, this code turns it into an</span>
    <span class="c1"># iterator for the rest of the recursive calls</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actions</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">num_actions</span> <span class="o">=</span> <span class="n">repeat</span><span class="p">(</span><span class="n">num_actions</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actions</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">num_actions</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">num_actions</span><span class="p">)</span>

    <span class="c1"># TODO: this copy doesn&#39;t actually work but I can dream</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">space_value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_box_into_tuple_of_discretes</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">space_value</span><span class="p">,</span> <span class="n">num_actions</span><span class="o">=</span><span class="n">num_actions</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_box_into_tuple_of_discretes</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">space_value</span><span class="p">,</span> <span class="n">num_actions</span><span class="o">=</span><span class="n">num_actions</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">spaces</span><span class="o">=</span><span class="n">new_dict</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
        <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_box_into_tuple_of_discretes</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span> <span class="n">num_actions</span><span class="o">=</span><span class="n">num_actions</span><span class="p">)</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">space</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">new_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_actions</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;num_actions must be iterator, received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">num_actions</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">([</span><span class="n">Discrete</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">num_actions</span><span class="p">)))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="o">.</span><span class="n">size</span><span class="p">)])</span>

    <span class="k">return</span> <span class="n">val</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont" class="doc doc-heading">
<code class="highlight language-python"><span class="n">turn_discrete_action_back_to_cont</span><span class="p">(</span><span class="n">original_space</span><span class="p">,</span> <span class="n">discrete_only_space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>This is a convenience wrapper for turn_orig_space_box_to_cont_sample</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont--parameters" title="Permanent link"></a></h5>
<div class="admonition original_space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the continuous space</p>
</div>
<div class="admonition discrete_only_space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the discrete space</p>
</div>
<div class="admonition space_sample">
<p class="admonition-title">sample_type</p>
<p>the sample of the discrete space</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont--returns" title="Permanent link"></a></h5>
<div class="admonition sample_type">
<p class="admonition-title">Sample_type</p>
<p>the continuous version of the discrete sample</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">turn_discrete_action_back_to_cont</span><span class="p">(</span>
    <span class="n">original_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
    <span class="n">discrete_only_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
    <span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a convenience wrapper for turn_orig_space_box_to_cont_sample</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    original_space: gym.spaces.Space</span>
<span class="sd">        the continuous space</span>
<span class="sd">    discrete_only_space: gym.spaces.Space</span>
<span class="sd">        the discrete space</span>
<span class="sd">    space_sample: sample_type</span>
<span class="sd">        the sample of the discrete space</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type:</span>
<span class="sd">        the continuous version of the discrete sample</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
        <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_orig_space_box_to_cont_sample</span><span class="p">,</span>
        <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">original_space</span><span class="p">,</span> <span class="n">discrete_only_space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">),</span>
        <span class="n">return_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace" class="doc doc-heading">
<code class="highlight language-python"><span class="n">turn_discrete_action_back_to_cont_powerspace</span><span class="p">(</span><span class="n">original_space</span><span class="p">,</span> <span class="n">discrete_only_space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">,</span> <span class="n">pow_n</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>This is a convenience wrapper for turn_orig_space_box_to_cont_sample_powerspace</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace--parameters" title="Permanent link"></a></h5>
<div class="admonition original_space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the continuous space</p>
</div>
<div class="admonition discrete_only_space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the discrete space</p>
</div>
<div class="admonition space_sample">
<p class="admonition-title">sample_type</p>
<p>the sample of the discrete space</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_discrete_action_back_to_cont_powerspace--returns" title="Permanent link"></a></h5>
<div class="admonition sample_type">
<p class="admonition-title">Sample_type</p>
<p>the continuous version of the discrete sample</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">turn_discrete_action_back_to_cont_powerspace</span><span class="p">(</span>
    <span class="n">original_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">discrete_only_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span> <span class="n">pow_n</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a convenience wrapper for turn_orig_space_box_to_cont_sample_powerspace</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    original_space: gym.spaces.Space</span>
<span class="sd">        the continuous space</span>
<span class="sd">    discrete_only_space: gym.spaces.Space</span>
<span class="sd">        the discrete space</span>
<span class="sd">    space_sample: sample_type</span>
<span class="sd">        the sample of the discrete space</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type:</span>
<span class="sd">        the continuous version of the discrete sample</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
        <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">turn_orig_space_box_to_cont_sample_powerspace</span><span class="p">,</span>
        <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">original_space</span><span class="p">,</span> <span class="n">discrete_only_space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">,</span> <span class="n">pow_n</span><span class="p">),</span>
        <span class="n">return_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample" class="doc doc-heading">
<code class="highlight language-python"><span class="n">turn_orig_space_box_to_cont_sample</span><span class="p">(</span><span class="n">space_likes</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Given a continuous space and a discrete space and a sample of the discrete space,
this function turns the discrete sample into a continuous sample</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample--parameters" title="Permanent link"></a></h5>
<div class="admonition space_likes">
<p class="admonition-title">typing.Tuple[gym.spaces.Space, gym.spaces.Space, sample_type]</p>
<p>the first is the original gym space that is continuous,
the second is the new gym space with discrete objects
the last is the space sample that is of discrete types</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample--returns" title="Permanent link"></a></h5>
<div class="admonition sample_type">
<p class="admonition-title">Sample_type</p>
<p>the sample space that is now a continuous version of the discrete sample space according to the cont space</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">turn_orig_space_box_to_cont_sample</span><span class="p">(</span><span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a continuous space and a discrete space and a sample of the discrete space,</span>
<span class="sd">    this function turns the discrete sample into a continuous sample</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space_likes: typing.Tuple[gym.spaces.Space, gym.spaces.Space, sample_type]</span>
<span class="sd">        the first is the original gym space that is continuous,</span>
<span class="sd">        the second is the new gym space with discrete objects</span>
<span class="sd">        the last is the space sample that is of discrete types</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type:</span>
<span class="sd">        the sample space that is now a continuous version of the discrete sample space according to the cont space</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">original_space_arg</span><span class="p">,</span> <span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">space_sample_arg</span><span class="p">)</span> <span class="o">=</span> <span class="n">space_likes</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_space_arg</span><span class="p">,</span>
                  <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">MultiDiscrete</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">))):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">MultiDiscrete</span><span class="p">):</span>
            <span class="n">possible_n</span> <span class="o">=</span> <span class="n">discrete_only_space_arg</span><span class="o">.</span><span class="n">nvec</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
            <span class="n">possible_n</span> <span class="o">=</span> <span class="n">discrete_only_space_arg</span><span class="o">.</span><span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This should not be reachable&quot;</span><span class="p">)</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">space_sample_arg</span>
        <span class="n">low</span> <span class="o">=</span> <span class="n">original_space_arg</span><span class="o">.</span><span class="n">low</span>
        <span class="n">high</span> <span class="o">=</span> <span class="n">original_space_arg</span><span class="o">.</span><span class="n">high</span>
        <span class="n">new_cont_sample</span> <span class="o">=</span> <span class="p">(</span><span class="n">action</span> <span class="o">/</span> <span class="p">(</span><span class="n">possible_n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">+</span> <span class="n">low</span>

        <span class="k">return</span> <span class="n">new_cont_sample</span>

    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace" class="doc doc-heading">
<code class="highlight language-python"><span class="n">turn_orig_space_box_to_cont_sample_powerspace</span><span class="p">(</span><span class="n">space_likes</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Given a continuous space and a discrete space and a sample of the discrete space,
this function turns the discrete sample into a continuous sample</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace--parameters" title="Permanent link"></a></h5>
<div class="admonition space_likes">
<p class="admonition-title">typing.Tuple[gym.spaces.Space, gym.spaces.Space, sample_type]</p>
<p>the first is the original gym space that is continuous,
the second is the new gym space with discrete objects
the last is the space sample that is of discrete types</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.turn_orig_space_box_to_cont_sample_powerspace--returns" title="Permanent link"></a></h5>
<div class="admonition sample_type">
<p class="admonition-title">Sample_type</p>
<p>the sample space that is now a continuous version of the discrete sample space according to the cont space</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">turn_orig_space_box_to_cont_sample_powerspace</span><span class="p">(</span>
    <span class="n">space_likes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">,</span> <span class="n">sample_type</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a continuous space and a discrete space and a sample of the discrete space,</span>
<span class="sd">    this function turns the discrete sample into a continuous sample</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space_likes: typing.Tuple[gym.spaces.Space, gym.spaces.Space, sample_type]</span>
<span class="sd">        the first is the original gym space that is continuous,</span>
<span class="sd">        the second is the new gym space with discrete objects</span>
<span class="sd">        the last is the space sample that is of discrete types</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type:</span>
<span class="sd">        the sample space that is now a continuous version of the discrete sample space according to the cont space</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># There is a test built for this function. Please keep the test up to date for any changes you make.</span>
    <span class="p">(</span><span class="n">original_space_arg</span><span class="p">,</span> <span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">space_sample_arg</span><span class="p">,</span> <span class="n">pow_n</span><span class="p">)</span> <span class="o">=</span> <span class="n">space_likes</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_space_arg</span><span class="p">,</span>
                  <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">))):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
            <span class="n">possible_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">n</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">discrete_only_space_arg</span><span class="p">])</span>
            <span class="n">pow_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pow_n</span><span class="p">)</span>
            <span class="n">discrete_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">discrete_only_space_arg</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">):</span>
            <span class="n">possible_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">discrete_only_space_arg</span><span class="o">.</span><span class="n">n</span><span class="p">])</span>
            <span class="n">pow_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">pow_n</span><span class="p">])</span>
            <span class="n">discrete_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">space_sample_arg</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This should not be reachable&quot;</span><span class="p">)</span>

        <span class="n">low</span> <span class="o">=</span> <span class="n">original_space_arg</span><span class="o">.</span><span class="n">low</span>
        <span class="n">high</span> <span class="o">=</span> <span class="n">original_space_arg</span><span class="o">.</span><span class="n">high</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">low</span> <span class="o">&gt;</span> <span class="n">high</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;lower bounds of space somehow higher than high bounds&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">possible_n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">pow_n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The exponential power factor not supported when possible_n % 2&quot;</span><span class="p">)</span>

            <span class="n">difference</span> <span class="o">=</span> <span class="n">high</span> <span class="o">-</span> <span class="n">low</span>
            <span class="n">movement_per_space_sample</span> <span class="o">=</span> <span class="n">difference</span> <span class="o">/</span> <span class="n">possible_n</span>

            <span class="n">new_cont_sample</span> <span class="o">=</span> <span class="n">low</span> <span class="o">+</span> <span class="p">(</span><span class="n">movement_per_space_sample</span> <span class="o">*</span> <span class="n">space_sample_arg</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">new_cont_sample</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">pow_n</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The exponential power factor used to stretch/shrink the discrete space must be greater than zero&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="o">-</span><span class="n">low</span> <span class="o">!=</span> <span class="n">high</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">low</span> <span class="o">&gt;=</span> <span class="n">high</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Currently only support symmetric space about zero for power space setup - TODO&quot;</span><span class="p">)</span>
        <span class="n">p_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">pow_n</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
        <span class="n">p_low</span> <span class="o">=</span> <span class="o">-</span><span class="n">p_high</span>  <span class="c1"># Since we have specified the space must be symetric around 0</span>
        <span class="n">new_cont_sample</span> <span class="o">=</span> <span class="p">(</span><span class="n">discrete_sample</span> <span class="o">/</span> <span class="p">(</span><span class="n">possible_n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">p_high</span> <span class="o">-</span> <span class="n">p_low</span><span class="p">)</span> <span class="o">+</span> <span class="n">p_low</span>
        <span class="n">new_cont_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">new_cont_sample</span><span class="p">),</span> <span class="n">pow_n</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">new_cont_sample</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_cont_sample</span>

    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space_sample_arg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unscale_sample_from_space</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">,</span> <span class="n">out_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_max</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>This is a convenience wrapper for box_unscaler</p>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space--parameters">Parameters<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space--parameters" title="Permanent link"></a></h5>
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>the gym space we will unscale to</p>
</div>
<div class="admonition space_sample">
<p class="admonition-title">sample_type</p>
<p>the sample we want to unscale. thus this is a scaled version of the input space
with a min,max defined by the arguments out_min,out_max</p>
</div>
<div class="admonition out_min">
<p class="admonition-title">float</p>
<p>the minimum of the sample</p>
</div>
<div class="admonition out_max">
<p class="admonition-title">float</p>
<p>the maximum of the sample</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.unscale_sample_from_space--returns" title="Permanent link"></a></h5>
<div class="admonition sample_type">
<p class="admonition-title">Sample_type</p>
<p>the unscaled version of the space_sample. Thus the space should now contain this output sample</p>
</div>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">unscale_sample_from_space</span><span class="p">(</span>
    <span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
    <span class="n">space_sample</span><span class="p">:</span> <span class="n">sample_type</span><span class="p">,</span>
    <span class="n">out_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">out_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sample_type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a convenience wrapper for box_unscaler</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        the gym space we will unscale to</span>
<span class="sd">    space_sample: sample_type</span>
<span class="sd">        the sample we want to unscale. thus this is a scaled version of the input space</span>
<span class="sd">        with a min,max defined by the arguments out_min,out_max</span>
<span class="sd">    out_min: float</span>
<span class="sd">        the minimum of the sample</span>
<span class="sd">    out_max: float</span>
<span class="sd">        the maximum of the sample</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sample_type:</span>
<span class="sd">        the unscaled version of the space_sample. Thus the space should now contain this output sample</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">iterate_over_space_likes</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">box_unscaler</span><span class="p">,</span>
        <span class="n">space_likes</span><span class="o">=</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">space_sample</span><span class="p">),</span>
        <span class="n">out_min</span><span class="o">=</span><span class="n">out_min</span><span class="p">,</span>
        <span class="n">out_max</span><span class="o">=</span><span class="n">out_max</span><span class="p">,</span>
        <span class="n">return_space</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="corl.libraries.env_space_util.EnvSpaceUtil.zero_mean_space" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zero_mean_space</span><span class="p">(</span><span class="n">space</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#corl.libraries.env_space_util.EnvSpaceUtil.zero_mean_space" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Returns a space object where every Box instance has its low and high shifted to be zero mean
Parameters</p>
<hr />
<div class="admonition space">
<p class="admonition-title">gym.spaces.Space</p>
<p>The gym space to zero mean</p>
</div>
<h5 id="corl.libraries.env_space_util.EnvSpaceUtil.zero_mean_space--returns">Returns<a class="headerlink" href="#corl.libraries.env_space_util.EnvSpaceUtil.zero_mean_space--returns" title="Permanent link"></a></h5>
<p>gym.spaces.Space
    A gym space the same as the input but with the Box instances shifted</p>

        <details class="quote">
          <summary>Source code in <code>corl/libraries/env_space_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">zero_mean_space</span><span class="p">(</span><span class="n">space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Space</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a space object where every Box instance has its low and high shifted to be zero mean</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    space: gym.spaces.Space</span>
<span class="sd">        The gym space to zero mean</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gym.spaces.Space</span>
<span class="sd">        A gym space the same as the input but with the Box instances shifted</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: this copy doesn&#39;t actually work but I can dream</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">):</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">zero_mean_space</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span><span class="n">spaces</span><span class="o">=</span><span class="n">new_dict</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">):</span>
        <span class="n">new_thing</span> <span class="o">=</span> <span class="p">[</span><span class="n">EnvSpaceUtil</span><span class="o">.</span><span class="n">zero_mean_space</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">space</span><span class="o">.</span><span class="n">spaces</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_thing</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">):</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">high</span> <span class="o">+</span> <span class="n">space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">zero_mean_box</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">low</span> <span class="o">-</span> <span class="n">mean</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">high</span> <span class="o">-</span> <span class="n">mean</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">space</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">zero_mean_box</span>

    <span class="k">return</span> <span class="n">val</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../env_func_base/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Env func base" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Env func base
            </div>
          </div>
        </a>
      
      
        
        <a href="../environment_dict/" class="md-footer__link md-footer__link--next" aria-label="Next: Environment dict" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Environment dict
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/act3-ace/CoRL/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://git.act3-ace.com/act3-rl/" target="_blank" rel="noopener" title="git.act3-ace.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="m503.5 204.6-.7-1.8-69.7-181.78c-1.4-3.57-3.9-6.59-7.2-8.64-2.4-1.55-5.1-2.515-8-2.81-2.9-.295-5.7.083-8.4 1.11-2.7 1.02-5.1 2.66-7.1 4.78-1.9 2.12-3.3 4.67-4.1 7.44l-47 144H160.8l-47.1-144c-.8-2.77-2.2-5.31-4.1-7.43-2-2.12-4.4-3.75-7.1-4.77a18.1 18.1 0 0 0-8.38-1.113 18.4 18.4 0 0 0-8.04 2.793 18.09 18.09 0 0 0-7.16 8.64L9.267 202.8l-.724 1.8a129.57 129.57 0 0 0-3.52 82c7.747 26.9 24.047 50.7 46.447 67.6l.27.2.59.4 105.97 79.5 52.6 39.7 32 24.2c3.7 1.9 8.3 4.3 13 4.3 4.7 0 9.3-2.4 13-4.3l32-24.2 52.6-39.7 106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top"], "search": "../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.37e9125f.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@8.4.2/dist/mermaid.min.js"></script>
      
    
  </body>
</html>